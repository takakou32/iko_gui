# プロセス実行GUIアプリケーション

複数のbatファイルの実行、CSVファイルの移動、ログの確認を含むプロセスをGUIで実行できるアプリケーションです。

## 技術要件

- PowerShell
- Windows Forms
- Windows標準機能のみを使用

## ファイル構成

- `Main.ps1` - メインのGUIアプリケーション
- `run.bat` - アプリケーション起動用のバッチファイル
- `config.json` - 設定ファイル（batファイルのパス、CSV移動設定など）
- `sample.bat`, `sample2.bat` - サンプルのbatファイル
- `ConvertToSJIS.ps1` - ファイルをSJISエンコーディングに変換するスクリプト
- `logs/` - ログファイルが保存されるディレクトリ（自動生成）

## 使用方法

### 1. 設定ファイルの編集

`config.json`を編集して、実行するプロセスを設定します。各プロセスは個別に実行できます。設定はページごとに記述できます。

```json
{
  "Title": "1.V1 移行ツール適用",
  "Pages": [
    {
      "Title": "1.V1 移行ツール適用",
      "Processes": [
        {
          "Name": "1.EB移行ツール適用",
          "ExecuteButtonText": "実行",
          "LogButtonText": "ログ確認",
          "BatchFiles": [
            {
              "Name": "バッチファイルの表示名",
              "Path": "バッチファイルのパス（相対パスまたは絶対パス）"
            }
          ],
          "CsvMoveOperations": [
            {
              "Source": "CSVファイルのソースディレクトリ",
              "Destination": "CSVファイルの移動先ディレクトリ"
            }
          ],
          "ExecutionDelay": 1
        }
      ]
    }
  ]
}
```

- `Title`: デフォルトのタイトル（ページにTitleがない場合に使用）
- `Pages`: ページの配列
  - `Title`: そのページのヘッダーに表示されるタイトル（オプション）
  - `Processes`: プロセスの配列（最大8つまで1ページに表示）
    - `Name`: テキストボックスに表示されるプロセス名
    - `ExecuteButtonText`: 実行ボタンに表示されるテキスト（デフォルト: "実行"）
    - `LogButtonText`: ログ確認ボタンに表示されるテキスト（デフォルト: "ログ確認"）
    - `BatchFiles`: 実行するbatファイルの配列
    - `CsvMoveOperations`: CSVファイルの移動操作の配列
    - `ExecutionDelay`: 実行間隔（秒）

### 2. アプリケーションの起動

以下のいずれかの方法でアプリケーションを起動できます：

**方法1: バッチファイルから起動（推奨）**
```
run.bat をダブルクリック
```

**方法2: PowerShellから起動**
```powershell
.\Main.ps1
```

または、PowerShellを右クリックして「実行」を選択します。

### 3. GUI操作

GUIは以下の構成になっています：

**ヘッダー部分（水色背景）**
- タイトル表示
- 左右の矢印ボタン（`<` `>`）でページ切り替え
- ページ情報表示

**プロセス制御エリア（黄色/ベージュ背景）**
- 2列×4行のレイアウトで最大8つのプロセスを表示
- 各行に3つのコントロール：
  - **テキストボックス（白）**: プロセスの名前を表示（読み取り専用）
  - **実行ボタン（オレンジ）**: そのプロセスを実行します（batファイルの実行とCSVファイルの移動）。ボタンのテキストはconfig.jsonで設定可能
  - **ログ確認ボタン（緑）**: そのプロセスのログファイルをメモ帳で開きます。ボタンのテキストはconfig.jsonで設定可能

**ログ表示エリア（下部）**
- 実行中のログをリアルタイムで表示
- スクロール可能なテキストエリア

## ログ

- 各プロセスのログファイルは`logs/`ディレクトリに保存されます
- ファイル名は`process_[プロセス番号].log`形式です
- 各batファイルの標準出力と標準エラー出力も`logs/`ディレクトリに保存されます（`process_[プロセス番号]_stdout.log`、`process_[プロセス番号]_stderr.log`）
- 「ログ確認」ボタンをクリックすると、そのプロセスのログファイルがメモ帳で開きます

## エンコーディングについて

- PowerShellスクリプト（.ps1）とbatファイル（.bat）はShift-JIS（SJIS）エンコーディングで保存してください
- ログファイルはUTF-8（BOMなし）で保存されます

### エンコーディング変換

初回セットアップ時、またはファイルを編集した後は、以下のコマンドでファイルをSJISエンコーディングに変換してください：

```powershell
.\ConvertToSJIS.ps1
```

このスクリプトは、`Main.ps1`、`sample.bat`、`sample2.bat`をSJISエンコーディングに変換します。

## 注意事項

- batファイルのパスは相対パスまたは絶対パスで指定できます
- 相対パスの場合、`Main.ps1`があるディレクトリを基準とします
- CSVファイルの移動先ディレクトリが存在しない場合、自動的に作成されます
